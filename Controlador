using APITest.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Web.Http;

namespace APITest.Controllers
{
    [RoutePrefix("api/produtos")]
    public class ProdutosController : ApiController
    {
        private static List<Produtos> produto = new List<Produtos>();

        [HttpPost]
        [Route("CadastrarProdutos")]

        public string CadastrarProdutos(Produtos insert)
        {
            if(insert.id_Produto == 0)
            {
                return "Não é possível cadastrar um produto com índice zerado!";
            }
            produto.Add(insert);
            return "Produtos cadastrados com sucesso!";
        }

        [HttpGet]
        [Route("ConsultarProdutos")]

        public List<Produtos> ConsultarProdutos()
        {
            return produto;
        }

        [HttpGet]
        [Route("ConsultarProdutosPorID/{id}")]

        public Produtos ConsultarProdutosPorID(int id)
        {

            Produtos prod = produto.Where(w => w.id_Produto == id).Select(w => w).FirstOrDefault();
            return prod;
        }


        [HttpPut]
        [Route("AtualizarProdutos")]

        public string AtualizarProdutos(Produtos update)
        {
            produto.Where(n => n.id_Produto == update.id_Produto).Select(s =>
            {

                s.id_Produto = update.id_Produto;
                s.ds_Produto = update.ds_Produto;
                s.qt_Produto = update.qt_Produto;
                s.vl_Produto = update.vl_Produto;

                return s;
            }).ToList();
            return "Produto atualizado com sucesso!";
        }

        [HttpDelete]
        [Route("ExcluirProdutos/{id}")]

        public string ExcluirProdutos(int id)
        {
            Produtos prod = produto.Where(s => s.id_Produto == id).Select(s => s).FirstOrDefault();
            produto.Remove(prod);

            return "Produto excluído com sucesso!";
        }
    }   
}

